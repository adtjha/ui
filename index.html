<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <title>UI Demo</title>
    <style>
      main {
        display: grid;
        gap: 2rem;
        grid-template-columns: 1fr 2fr 1fr;
        grid-template-rows: 1fr;
      }

      #userProfile {
        grid-column: 1 / 2;
        grid-row: 1 / 3;
      }

      #retirementSection {
        grid-column: 2 / 3;
        grid-row: 1 / 2;
      }

      #peerComparison {
        grid-column: 2 / 3;
        grid-row: 2 / 3;
      }

      #retirementStrategy {
        grid-column: 3 / 4;
        grid-row: 1 / 2;
      }

      #updateButton {
        margin: 0;
      }

      input[type="range"] {
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        outline: none;
        width: 100%;
        height: 3px;
        border-radius: 5px;
      }

      input[type="range"]::-webkit-slider-runnable-track {
        height: 3px;
        border-radius: 50px;
      }
      input[type="range"]::-webkit-slider-thumb {
        background: #fafafa;
        appearance: none;
        box-shadow: 1px 2px 26px 1px #bdbdbd;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        margin-top: -8px;
      }

      @media screen and (max-width: 1000px) {
        main {
          display: flex;
          flex-direction: column;
          /* grid-template-columns: 1fr; */
          /* grid-template-rows: 1fr; */
          align-items: stretch;
          justify-content: flex-start;
        }

        #userProfile {
          grid-column: auto;
          grid-row: auto;
        }

        #retirementSection {
          grid-column: auto;
          grid-row: auto;
        }

        #peerComparison {
          grid-column: auto;
          grid-row: auto;
        }

        #retirementStrategy {
          grid-column: auto;
          grid-row: auto;
        }
      }
    </style>
  </head>
  <body>
    <nav
      class="fixed bottom-0 lg:top-0 inset-x-0 lg:inset-x-[auto] w-full lg:w-fit lg:h-full bg-white py-4 lg:py-4 lg:px-3 z-10 flex lg:flex-col lg:items-center lg:justify-center"
    >
      <ul
        class="hidden lg:block mb-12 flex flex-col items-start justify-center space-y-2"
      >
        <li>
          <img src="./logo.png" alt="logo" class="w-10 h-10" />
        </li>
        <li>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6 stroke-gray-400 m-auto"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
            />
          </svg>
        </li>
      </ul>

      <ul
        class="lg:flex-grow w-full flex flex-row lg:flex-col items-center justify-evenly lg:justify-start lg:gap-8"
      >
        <li class="bg-indigo-500 p-2 rounded-lg">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6 stroke-white"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"
            />
          </svg>
        </li>
        <li>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6 stroke-gray-400"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"
            />
          </svg>
        </li>
        <li>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6 stroke-gray-400"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"
            />
          </svg>
        </li>
        <li>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6 stroke-gray-400"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
            />
          </svg>
        </li>
        <li class="lg:hidden">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6 stroke-gray-400"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
            />
          </svg>
        </li>
      </ul>

      <ul
        class="hidden lg:block flex flex-col items-start justify-center space-y-4"
      >
        <li>
          <div
            id="notification"
            class="flex flex-row items-center justify-end after:content-['.'] after:-ml-2 after:-mt-12 after:text-indigo-500 after:text-5xl"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-6 w-6 stroke-gray-400"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"
              />
            </svg>
          </div>
        </li>
        <li>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6 stroke-gray-400 m-auto"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"
            />
          </svg>
        </li>
      </ul>
    </nav>

    <main
      class="p-8 lg:p-0 lg:mb-auto lg:ml-[65px] snap-y snap-proximity overflow-y-auto"
    >
      <div
        id="notification"
        class="z-30 lg:hidden absolute right-2 bg-white rounded-full p-2 flex flex-row items-center justify-end after:content-['.'] after:-ml-2 after:-mt-12 after:text-indigo-500 after:text-5xl"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-6 w-6 stroke-gray-400"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
          stroke-width="2"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"
          />
        </svg>
      </div>

      <div
        id="userProfile"
        class="w-full lg:bg-indigo-50 flex flex-col items-stretch justify-start space-y-8 py-8 lg:px-8 mb-12 lg:mb-0 snap-start shrink-0"
      >
        <div id="user" class="flex flex-row items-center justify-start gap-4">
          <img
            class="w-16 h-16 rounded-full shadow-md"
            src="./profilePic.png"
            alt="photo"
          />
          <div
            class="flex flex-col items-start justify-start flex-grow text-left"
          >
            <h2 class="w-fit text-2xl font-[500]">Hi Mike,</h2>
            <h5 class="w-fit text-xs text-gray-500">welcome back</h5>
          </div>
        </div>
        <div
          id="summary"
          class="bg-gray-100 lg:bg-transparent rounded-2xl px-6 lg:px-0 py-4 grid grid-cols-2 lg:grid-cols-1 grid-rows-3 lg:grid-rows-[auto] lg:gap-6 items-center justify-evenly space-y-8 lg:space-y-0"
        >
          <div id="balance" class="col-span-2 lg:col-span-1">
            <h4 class="font-[500] lg:mb-2">Today</h4>
            <h1 class="text-4xl lg:text-3xl font-bold mb-2">$19,892</h1>
            <h5 class="text-xs text-gray-500">Account Balance</h5>
          </div>
          <div class="row-span-1 flex flex-col items-start justify-start">
            <h4 class="text-lg font-bold mb-1">$4,000</h4>
            <h5 class="text-xs text-gray-500">Year-to-Date</h5>
          </div>
          <div class="row-span-1 flex flex-col items-start justify-start">
            <h4 class="text-lg font-bold mb-1">$4,000</h4>
            <h5 class="text-xs text-gray-500">Year-to-Date</h5>
          </div>
          <button
            class="col-span-2 lg:col-span-1 w-4/5 lg:w-fit lg:h-fit px-4 py-2 rounded-lg bg-indigo-500 text-white m-auto lg:mx-0"
          >
            <select name="" id="" class="w-fit bg-transparent">
              <option value="">I want to...</option>
            </select>
          </button>
        </div>
        <div
          id="recent"
          class="bg-gray-100 lg:bg-transparent rounded-2xl px-6 lg:px-0 py-4 flex flex-col items-stretch justify-evenly space-y-2"
        >
          <h4 class="font-[500]">Recent Transactions</h4>
          <div class="flex flex-col items-stretch justify-evenly">
            <div id="transaction" class="border-b border-gray-300 py-4">
              <h5 class="text-xs text-gray-500">2020-08-07</h5>
              <h4 class="text-sm font-[500]">
                Withdrawal Transfer to Bank-XX11
              </h4>
            </div>
            <div id="transaction" class="border-b border-gray-300 py-4">
              <h5 class="text-xs text-gray-500">2020-07-01</h5>
              <h4 class="text-sm font-[500]">
                Withdrawal Transfer to Bank-XX11
              </h4>
            </div>
            <div id="transaction" class="py-4">
              <h5 class="text-xs text-gray-500">2020-07-16</h5>
              <h4 class="text-sm font-[500]">
                Withdrawal Transfer to Bank-XX11
              </h4>
            </div>
          </div>
        </div>
      </div>

      <div
        id="retirementIncomeSection"
        class="w-full flex flex-col items-stretch justify-start space-y-8 lg:space-y-8 py-8 lg:pb-2 mb-12 lg:mb-0 snap-start shrink-0"
      >
        <div class="flex flex-col items-start justify-center">
          <h4 class="font-[500] lg:text-sm text-indigo-500">
            Retirement Income
          </h4>
          <h1 class="text-2xl lg:text-xl font-bold">Starting Year 2056</h1>
        </div>
        <div
          class="grid grid-rows-2 lg:grid-rows-1 grid-cols-2 lg:grid-cols-3 items-stretch justify-center gap-x-4 lg:gap-4"
        >
          <div
            class="col-span-2 lg:col-span-1 w-full flex flex-col items-stretch justify-start gap-2 lg:gap-0.5 mt-4 lg:mt-0 py-2 border-b-2 border-indigo-300"
          >
            <h1 class="text-xl lg:text-2xl font-bold">$300,000</h1>
            <h4 class="text-gray-400 text-sm lg:text-xs">My Goal</h4>
          </div>
          <div
            class="w-full flex flex-col items-stretch justify-start gap-2 lg:gap-0.5 mt-4 lg:mt-0 py-2 border-b-2 border-indigo-300"
          >
            <h2 class="text-xl lg:text-2xl font-bold">59%</h2>
            <h5 class="text-gray-400 text-sm lg:text-xs">Goal Achieved</h5>
          </div>
          <div
            class="w-full flex flex-col items-stretch justify-start gap-2 lg:gap-0.5 mt-4 lg:mt-0 py-2 border-b-2 border-indigo-300"
          >
            <h2 class="text-xl lg:text-2xl font-bold">K 300</h2>
            <h5 class="text-gray-400 text-sm lg:text-xs">
              Est. Monthly Income
            </h5>
          </div>
        </div>
        <div class="w-full flex flex-col items-start justify-center gap-3">
          <h2 class="font-bold text-xl lg:text-lg">Contributions Overtime</h2>
          <div class="w-full flex flex-row items-center justify-between">
            <div
              class="flex flex-col lg:flex-row items-start lg:items-center justify-evenly gap-1 lg:gap-2"
            >
              <div class="w-3 h-2 bg-blue-900 rounded-full my-2"></div>
              <h5 class="text-gray-400 text-xs capitalize">Employer</h5>
              <h1 class="font-[500] text-lg lg:text-xs">$73,500</h1>
            </div>
            <div
              class="flex flex-col lg:flex-row items-start lg:items-center justify-evenly gap-1 lg:gap-2"
            >
              <div class="w-3 h-2 bg-blue-600 rounded-full my-2"></div>
              <h5 class="text-gray-400 text-xs capitalize">Employee</h5>
              <h1 class="font-[500] text-lg lg:text-xs">$52,500</h1>
            </div>
            <div
              class="flex flex-col lg:flex-row items-start lg:items-center justify-evenly gap-1 lg:gap-2"
            >
              <div class="w-3 h-2 bg-blue-300 rounded-full my-2"></div>
              <h5 class="text-gray-400 text-xs capitalize">Total Interest</h5>
              <h1 class="font-[500] text-lg lg:text-xs">$244,313</h1>
            </div>
          </div>
          <div
            id="chart"
            class="w-full min-w-[300px] min-h-[300px] flex flex-row items-center justify-center"
          ></div>
        </div>
      </div>

      <div
        id="peerComparison"
        class="w-full flex flex-col items-stretch justify-start space-y-8 py-8 pb-0 lg:pt-0 lg:mb-0 snap-start shrink-0"
      >
        <div class="flex flex-col items-start justify-center gap-1 lg:gap-2">
          <h1 class="text-xl font-[500]">How do I compare to my peers?</h1>
          <h3 class="text-sm lg:text-xs font-[500] text-gray-400">
            These numbers represent current goal achievement.
          </h3>
        </div>
        <div class="flex flex-col lg:flex-row items-start justify-start gap-8">
          <div
            class="w-full lg:w-fit flex flex-col items-stretch justify-center"
          >
            <div
              class="flex flex-row items-center justify-start gap-2 text-xl lg:text-base py-3 border-b-2 border-indigo-100"
            >
              <h1 class="mr-4 font-[500]">Age:</h1>
              <select class="bg-white w-fit" name="age" id="age">
                <option value="under30">Under 30</option>
                <option value="30-60">Under 40</option>
                <option value="above60">Above 60</option>
              </select>
            </div>
            <div
              class="flex flex-row items-center justify-start gap-2 text-xl lg:text-base py-3 border-b-2 border-indigo-100"
            >
              <h1 class="mr-4 font-[500]">Salary:</h1>
              <select class="bg-white w-fit" name="salary" id="salary">
                <option value="20k-30k">K 20 - K 30</option>
                <option value="30k-60k">K 30 - K 60</option>
                <option value="60k-80k">K 60 - K 80</option>
              </select>
            </div>
            <div
              class="flex flex-row items-center justify-start gap-2 text-xl lg:text-base py-3"
            >
              <h1 class="mr-4 font-[500]">Gender:</h1>
              <select class="bg-white w-fit" name="gender" id="gender">
                <option value="female">Female</option>
                <option value="male">Male</option>
                <option value="other">Other</option>
              </select>
            </div>
          </div>
          <div
            id="pieCharts"
            class="w-full flex flex-row items-center justify-evenly"
          >
            <div
              id="pieChart1"
              class="min-w-[120px] min-h-[120px] flex flex-col-reverse items-center justify-start gap-1"
            >
              <h1 class="font-bold">Average</h1>
            </div>
            <div
              id="pieChart2"
              class="min-w-[120px] min-h-[120px] flex flex-col-reverse items-center justify-start gap-1"
            >
              <h1 class="font-bold">Top</h1>
            </div>
            <div
              id="pieChart3"
              class="min-w-[120px] min-h-[120px] flex flex-col-reverse items-center justify-start gap-1"
            >
              <h1 class="font-bold">Me</h1>
            </div>
          </div>
        </div>
      </div>

      <div
        id="retirementStrategy"
        class="w-full py-8 pt-0 lg:pt-8 lg:px-4 mb-0 snap-end shrink-0"
      >
        <div
          class="flex flex-col items-stretch justify-start gap-4 bg-blue-50 -mx-8 lg:mx-0 py-8 pb-0 lg:p-8 rounded-t-[3rem] lg:rounded-lg"
        >
          <h1 class="text-2xl px-8 lg:px-0 lg:text-xl font-[500]">
            Retirement Strategy
          </h1>
          <div
            class="flex flex-col items-start justify-center gap-4 lg:gap-8 px-8 lg:px-0 py-4"
          >
            <div
              class="w-full flex flex-col items-stretch justify-center gap-2 text-lg lg:text-sm"
            >
              <label for="employeeContibution" class="font-[500]"
                >Employee Contribution</label
              >
              <div
                class="w-full flex flex-row items-center justify-between gap-4"
              >
                <input
                  type="range"
                  name="employeeContibution"
                  class="flex-grow"
                  id="employeeContibution"
                  min="3"
                  max="15"
                  step="1"
                  value="12"
                  style="
                    background: linear-gradient(
                      to right,
                      #a5b4fc,
                      #a5b4fc 66.67%,
                      #eee 66.67%
                    );
                  "
                  oninput="showVal(this, '.employeeContibution-output')"
                />
                <span
                  class="font-[500] bg-white rounded-lg flex flex-row items-center justify-evenly divide-x-2 gap-2 lg:gap-0"
                >
                  <output
                    class="employeeContibution-output p-2 lg:p-1"
                    for="employeeContibution"
                    >12</output
                  >
                  <span class="p-2 lg:p-1">%</span>
                </span>
              </div>
            </div>
            <div
              class="w-full flex flex-col items-stretch justify-center gap-2 text-lg lg:text-sm"
            >
              <label for="retirementAge" class="font-[500]"
                >Retirement Age</label
              >
              <div
                class="w-full flex flex-row items-center justify-start gap-4"
              >
                <input
                  type="range"
                  name="retirementAge"
                  class="flex-grow bg-indigo-400"
                  id="retirementAge"
                  min="20"
                  max="80"
                  step="1"
                  value="65"
                  oninput="showVal(this, '.retirementAge-output')"
                  style="
                    background: linear-gradient(
                      to right,
                      #a5b4fc,
                      #a5b4fc 75%,
                      #eee 75%
                    );
                  "
                />
                <span class="font-[500] p-2 lg:p-1 bg-white rounded-lg">
                  <output
                    class="retirementAge-output p-2 lg:p-1"
                    for="retirementAge"
                    >65</output
                  >
                </span>
              </div>
            </div>
            <div
              class="w-full flex flex-row items-center justify-between gap-2 text-lg lg:text-sm"
            >
              <label class="font-[500]" for="employerContribution"
                >Employer Contribution</label
              >
              <span class="font-[500]">
                <output
                  class="employerContribution-output"
                  for="employerContribution"
                  >8.4%</output
                >
              </span>
            </div>
            <div
              class="w-full flex flex-row items-center justify-between gap-2 text-lg lg:text-sm"
            >
              <label class="font-[500]" for="interestRate">Interest Rate</label>
              <span class="font-[500]">
                <output class="interestRate-output" for="interestRate"
                  >5%</output
                >
              </span>
            </div>
          </div>
          <button
            id="updateButton"
            class="z-20 w-full px-4 py-4 lg:py-3 bg-indigo-500 rounded lg:rounded-xl text-white font-bold text-lg"
          >
            Update
          </button>
          <a
            class="text-indigo-500 text-xs font-bold flex flex-row items-center justify-center"
            href="#"
            >View Help Docs
            <span
              ><svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-4 w-4"
                viewBox="0 0 20 20"
                fill="currentColor"
              >
                <path
                  fill-rule="evenodd"
                  d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
                  clip-rule="evenodd"
                /></svg></span
          ></a>
        </div>

        <div
          class="hidden lg:flex mt-8 h-fit border-l-2 border-indigo-500 px-8 flex-col items-start justify-start gap-2"
        >
          <h1 class="flex flex-col items-start justify-center text-sm">
            Are you considering a
            <span class="font-bold">Housing Advance?</span>
          </h1>
          <h3 class="text-gray-400 text-xs">Limited time reduced interest.</h3>
          <a
            class="text-indigo-500 text-xs font-bold flex flex-row items-center justify-start"
            href="#"
            >Learn More
            <span
              ><svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-4 w-4"
                viewBox="0 0 20 20"
                fill="currentColor"
              >
                <path
                  fill-rule="evenodd"
                  d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
                  clip-rule="evenodd"
                /></svg></span
          ></a>
        </div>
      </div>
    </main>

    <img
      src="./corner.png"
      alt="artwork"
      class="hidden lg:block fixed bottom-0 right-0 w-[144px]"
    />

    <script>
      let sliderScale = (i, j) =>
        d3.scaleLinear().domain([i, j]).range([0, 100]);

      let showVal = (e, n) => {
        document.querySelector(n).innerHTML = e.value;
        let v;
        switch (n) {
          case ".employeeContibution-output":
            v = sliderScale(3, 15)(e.value);
            e.style.background = `linear-gradient(to right,#a5b4fc,#a5b4fc ${v}%,#eee ${v}%)`;
            break;
          case ".retirementAge-output":
            v = sliderScale(20, 80)(e.value);
            console.log(e);
            e.style.background = `linear-gradient(to right,#a5b4fc,#a5b4fc ${v}%,#eee ${v}%)`;
            break;
        }
      };

      let chartData = [
        [20, 20, 25],
        [40, 40, 50],
        [60, 60, 75],
        [80, 80, 100],
        [100, 100, 125],
        [120, 120, 150],
        [140, 140, 175],
      ];

      let pieChartData = {
        avg: 78,
        top: 95,
        me: 59,
      };

      let pieChart1 = d3.select("#pieChart1");
      let pieChart2 = d3.select("#pieChart2");
      let pieChart3 = d3.select("#pieChart3");

      let pieSize = 80;
      let pieMargin = 20;
      let pieTextSize = 24;

      let pieChart1_SVG = pieChart1
        .append("svg")
        .attr("height", pieSize + pieMargin)
        .attr("width", pieSize + pieMargin);

      let pieChart2_SVG = pieChart2
        .append("svg")
        .attr("height", pieSize + pieMargin)
        .attr("width", pieSize + pieMargin);

      let pieChart3_SVG = pieChart3
        .append("svg")
        .attr("height", pieSize + pieMargin)
        .attr("width", pieSize + pieMargin);

      pieChart1_SVG
        .append("circle")
        .attr("cx", pieSize / 2 + pieMargin / 2)
        .attr("cy", pieSize / 2 + pieMargin / 2)
        .attr("r", pieSize / 2)
        .attr("stroke-width", pieSize / 14)
        .attr("stroke", "#a7f3d0")
        .attr("fill", "#f0fdf4");

      pieChart2_SVG
        .append("circle")
        .attr("cx", pieSize / 2 + pieMargin / 2)
        .attr("cy", pieSize / 2 + pieMargin / 2)
        .attr("r", pieSize / 2)
        .attr("stroke-width", pieSize / 14)
        .attr("stroke", "#a7f3d0")
        .attr("fill", "#f0fdf4");

      pieChart3_SVG
        .append("circle")
        .attr("cx", pieSize / 2 + pieMargin / 2)
        .attr("cy", pieSize / 2 + pieMargin / 2)
        .attr("r", pieSize / 2)
        .attr("stroke-width", pieSize / 14)
        .attr("stroke", "#a7f3d0")
        .attr("fill", "#f0fdf4");

      let pieScale = d3.scaleLinear().domain([0, 100]).range([0, 360]);

      let arc = (deg) =>
        d3
          .arc()
          .innerRadius(38)
          .outerRadius(42)
          .startAngle(0)
          .padAngle(20 * 0.0174533)
          .endAngle(deg * 0.0174533);

      pieChart1_SVG
        .append("path")
        .attr(
          "transform",
          `translate(${pieSize / 2 + pieMargin / 2},${
            pieSize / 2 + pieMargin / 2
          })`
        )
        .attr("d", `${arc(pieScale(78))()}`)
        .attr("stroke-width", pieSize / 14)
        .attr("stroke", "#10b981")
        .attr("fill", "none");

      pieChart2_SVG
        .append("path")
        .attr(
          "transform",
          `translate(${pieSize / 2 + pieMargin / 2},${
            pieSize / 2 + pieMargin / 2
          })`
        )
        .attr("d", `${arc(pieScale(95))()}`)
        .attr("stroke-width", pieSize / 14)
        .attr("stroke", "#10b981")
        .attr("fill", "none");

      pieChart3_SVG
        .append("path")
        .attr(
          "transform",
          `translate(${pieSize / 2 + pieMargin / 2},${
            pieSize / 2 + pieMargin / 2
          })`
        )
        .attr("d", `${arc(pieScale(59))()}`)
        .attr("stroke-width", pieSize / 14)
        .attr("stroke", "#10b981")
        .attr("fill", "none");

      pieChart1_SVG
        .append("text")
        .attr("x", 36)
        .attr("y", 60)
        .text(78)
        .style("font-size", "24px")
        .style("font-weight", "600")
        .append("tspan")
        .attr("y", 52)
        .attr("baseline-shift", "super")
        .style("font-size", "12px")
        .style("font-weight", "400")
        .text("%");

      pieChart2_SVG
        .append("text")
        .attr("x", 36)
        .attr("y", 60)
        .text(95)
        .style("font-size", "24px")
        .style("font-weight", "600")
        .append("tspan")
        .attr("y", 52)
        .attr("baseline-shift", "super")
        .style("font-size", "12px")
        .style("font-weight", "400")
        .text("%");

      pieChart3_SVG
        .append("text")
        .attr("x", 36)
        .attr("y", 60)
        .text(59)
        .style("font-size", "24px")
        .style("font-weight", "600")
        .append("tspan")
        .attr("y", 52)
        .attr("baseline-shift", "super")
        .style("font-size", "12px")
        .style("font-weight", "400")
        .text("%");

      let local = d3.local();

      let height = d3.select("#chart").node().getBoundingClientRect().height;
      let width = d3.select("#chart").node().getBoundingClientRect().width;
      let margin = { top: 20, right: 30, bottom: 30, left: 40 };

      let yScale = d3
        .scaleLinear()
        .domain([
          0,
          d3.max([...chartData.map((a) => a.reduce((x, y) => x + y))]),
        ])
        .range([height - margin.bottom, margin.top]);

      let yBarScale = (i, j) =>
        d3
          .scaleLinear()
          .domain([0, d3.max([...chartData.flat()])])
          .range([i, j]);

      let yAxisLabels = d3
        .axisLeft(yScale)
        .tickValues([0, 100, 200, 300, 400])
        .tickFormat((x) => `$ ${x}`);

      let xScale = d3
        .scaleBand()
        .domain(d3.range(0, chartData.length))
        .padding(0.4)
        .range([margin.left, width - margin.right])
        .round(true);

      let xAxisLabels = d3
        .axisBottom(xScale)
        .tickFormat((x, i) => (x = [20, 35, 40, 45, 50, 55, 60][i]));

      let remapped = chartData.map(function (data, i) {
        let adder = 0;
        console.log(`----------------------------`);
        return data.map(function (d, j, a) {
          adder += d;
          return {
            x: xScale(i),
            y: yScale(adder),
            h: yScale(0) - yScale(d),
            w: xScale.bandwidth(),
            d: yBarScale(0, d3.max([...a]))(d),
            v: d,
            c:
              j === 0
                ? `fill-indigo-900`
                : j === 1
                ? `fill-indigo-600`
                : `fill-indigo-300`,
            t: i === 6 ? true : false,
          };
        });
      });

      console.log(remapped);

      let chart = d3
        .select("#chart")
        .append("svg")
        .attr("width", width)
        .attr("height", height);

      chart
        .append("g")
        .attr("transform", `translate(${margin.left},0)`)
        .call(yAxisLabels)
        .call((g) => g.select(".domain").remove())
        .call((g) => g.selectAll("line").remove())
        .call((g) =>
          g
            .selectAll("g")
            .attr("stroke-width", "2")
            .attr("stroke", "#d1d5db")
            .append("path")
            .attr("stroke-dasharray", "5,5")
            .attr("d", `M5 0 l${width - margin.left - margin.right} 0`)
        )
        .call((g) => g.select("g").select("path").remove())
        .call((g) =>
          g
            .selectAll("text")
            .attr("font-size", "small")
            .attr("font-weight", "600")
            .attr("fill", "#6b7280")
            .attr("stroke-width", "0")
        );

      chart
        .append("g")
        .attr("transform", `translate(0,${height - margin.bottom})`)
        .call(xAxisLabels)
        .call((g) => g.select(".domain").remove())
        .call((g) => g.selectAll("line").remove())
        .call((g) =>
          g
            .selectAll("text")
            .attr("font-size", "small")
            .attr("font-weight", "600")
            .attr("fill", "#6b7280")
        );

      chart
        .append("g")
        .selectAll("g")
        .data(remapped)
        .join("g")
        .selectAll("rect")
        .data((d) => d)
        .join((enter) => {
          enter
            .append("rect")
            .attr("width", (d) => {
              return d.w;
            })
            .attr("height", (d) => {
              return d.h;
            })
            .attr("x", (d) => {
              return d.x;
            })
            .attr("y", (d) => {
              return d.y;
            })
            .attr("class", (d) => d.c)
            .attr("data-value", (d) => d.v);
        });

      let tickRadius = 6;

      chart
        .append("g")
        .attr("class", "tickGroup")
        .attr(
          "transform",
          `translate(${
            remapped[remapped.length - 1][
              remapped[remapped.length - 1].length - 1
            ].x +
            xScale.bandwidth() -
            tickRadius * 2
          }, ${
            remapped[remapped.length - 1][
              remapped[remapped.length - 1].length - 1
            ].y - tickRadius
          })`
        );

      chart
        .select(".tickGroup")
        .append("circle")
        .attr("r", tickRadius)
        .attr("cx", 10)
        .attr("cy", 10)
        .style("fill", "white");

      chart
        .select(".tickGroup")
        .append("path")
        .attr("fill-rule", "evenodd")
        .attr("clip-rule", "evenodd")
        .attr(
          "d",
          "M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
        )
        .attr("fill", "#4ade80");
    </script>
  </body>
</html>
